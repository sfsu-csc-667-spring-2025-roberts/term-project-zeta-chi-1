<!DOCTYPE html>
<html lang="en">
<head>
    <!--_____________________________________________________________________________________________-->
    <!-- HEAD SECTION -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UNO Homepage</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>

<!--_____________________________________________________________________________________________-->
<!-- HEADER / TOP BAR -->

<header class="top-bar">
    <div class="logo">
        <a href="/home">
            <img src="/favicon.ico" id="top-bar-logo" alt="Play UNO!" />
        </a>
    </div>
    <div class="account-menu">
        <button id="account-icon" class="account-icon">ðŸ‘¤</button>
        <div id="dropdown-menu" class="dropdown-content hidden">
            <a href="/settings">Settings</a>
            <a href="#" id="logout-link">Logout</a>
        </div>
    </div>
</header>

<!--_____________________________________________________________________________________________-->
<!-- MAIN CONTAINER -->

<div class="container">
    <h1 style="color: white">Welcome to UNO!</h1>
    <p id="status-message" style="text-align: center; margin: 20px 0; color: white">
    </p>

    <!--_____________________________________________________________________________________________-->
    <!-- GAME SECTION -->

    <div class="game-section">
        <h2>Create a Game</h2>
        <div class="create-game-form">
            <input type="text" id="game-name-input" class="game-name" placeholder="Game Name" required>
            <select id="max-players-select">
                <option value="2">2 Players</option>
                <option value="3">3 Players</option>
                <option value="4">4 Players</option>
            </select>
            <button id="create-game-btn" disabled>Create Game</button>
        </div>

        <!--_____________________________________________________________________________________________-->
        <!-- GAME LOBBIES LIST -->

        <div class="section-title">
            <h2>Game Lobbies</h2>
            <button class="refresh-btn" id="refresh-lobbies">Refresh</button>
        </div>
        <p>Join an existing game lobby:</p>
        <ul id="lobby-list" class="lobby-list">
            <li>Loading lobbies...</li>
        </ul>

        <!--_____________________________________________________________________________________________-->
        <!-- ACTIVE GAMES LIST  -->

        <!--
        <div class="section-title">
            <h2>Active Games</h2>
            <button class="refresh-btn" id="refresh-games">Refresh</button>
        </div>
        <p>Resume or spectate active games:</p>
        <ul id="games-list" class="games-list">
            <li>Loading games...</li>
        </ul>
        -->

        <!--_____________________________________________________________________________________________-->
        <!-- USER STATS -->

        <h2 class="stats-header">Your Stats</h2>
        <div class="stats-container">
            <div class="stat-box">
                <h3>Wins</h3>
                <p id="user-wins">Loading...</p>
            </div>
            <div class="stat-box">
                <h3>Losses</h3>
                <p id="user-losses">Loading...</p>
            </div>
        </div>
    </div>
</div>

<!--_____________________________________________________________________________________________-->
<!-- JAVASCRIPT: AVATAR LOGIC -->

<script>
    document.addEventListener('DOMContentLoaded', async () => {
        try {
            const res = await fetch('/api/auth/me');
            if (!res.ok) return;

            const data = await res.json();
            const avatarData = data.user?.avatarData;

            if (!avatarData) return;

            const accountIcon = document.getElementById('account-icon');
            accountIcon.textContent = ''; // Clear the ðŸ‘¤ emoji


            const avatarContainer = document.createElement('div');
            avatarContainer.style.position = 'relative';
            avatarContainer.style.width = '40px';
            avatarContainer.style.height = '40px';
            avatarContainer.style.borderRadius = '50%';
            avatarContainer.style.overflow = 'hidden';
            avatarContainer.style.background = '#fff';


            for (const part of ['skin', 'clothes', 'eyes', 'head', 'mouth']) {
                const img = document.createElement('img');
                img.src = avatarData[part];
                img.style.position = 'absolute';
                img.style.top = '0';
                img.style.left = '0';
                img.style.width = '100%';
                img.style.height = '100%';
                img.style.objectFit = 'contain';
                avatarContainer.appendChild(img);
            }

            accountIcon.appendChild(avatarContainer);
        } catch (err) {
            console.error('Failed to load avatar:', err);
        }
    });
</script>

<!--_____________________________________________________________________________________________-->
<!-- JAVASCRIPT: SOCKET + PAGE SCRIPT -->

<script src="/socket.io/socket.io.js"></script>
<script src="/js/home.js"></script>

</body>
</html>
